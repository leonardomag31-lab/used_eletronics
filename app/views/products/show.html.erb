<h1><%= @product.title %></h1>
<p>R$ <%= @product.price %></p>
<p><%= @product.description %></p>

<% if @product.images.attached? %>
  <!-- Carousel principal -->
  <div id="productCarousel" class="carousel slide mb-3" data-bs-ride="carousel">
    <div class="carousel-inner">
      <% @product.images.each_with_index do |image, index| %>
        <div class="carousel-item <%= 'active' if index.zero? %>">
          <%= image_tag image.variant(resize_to_limit: [600, 400]).processed,
                        class: "d-block w-100",
                        alt: "#{@product.title} - imagem #{index + 1}" %>
        </div>
      <% end %>
    </div>

    <% if @product.images.size > 1 %>
      <!-- Controles do carousel -->
      <button class="carousel-control-prev" type="button" data-bs-target="#productCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Anterior</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#productCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Próximo</span>
      </button>

      <!-- Thumbnails clicáveis -->
      <div class="d-flex justify-content-center mt-3">
        <% @product.images.each_with_index do |image, index| %>
          <%= image_tag image.variant(resize_to_limit: [100, 80]).processed,
                        class: "img-thumbnail mx-1 thumbnail-img",
                        data: { bs_target: "#productCarousel", bs_slide_to: index },
                        style: "cursor:pointer;" %>
        <% end %>
      </div>
    <% end %>
  </div>
<% else %>
  <p>Sem imagens disponíveis para este produto.</p>
<% end %>

<div class="mt-3">
  <%= link_to "Voltar", products_path, class: "btn btn-secondary" %>
  <% if @product.user == current_user %>
    <%= link_to "Editar", edit_product_path(@product), class: "btn btn-primary ms-2" %>
  <% end %>
</div>
